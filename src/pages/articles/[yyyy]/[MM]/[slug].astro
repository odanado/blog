---
import type { CollectionEntry } from "astro:content";
import { getCollection } from "astro:content";
import { format } from "date-fns";
import BaseLayout from "../../../../layouts/base-layout.astro";

type Props = {
  entry: CollectionEntry<"articles">;
};

export async function getStaticPaths() {
  const articlesEntries = await getCollection("articles");

  return articlesEntries.map((entry) => {
    const [yyyy, MM, slug] = entry.slug.split("/");
    return {
      params: { yyyy, MM, slug },
      props: { entry },
    };
  });
}
const { entry } = Astro.props;
const pageTitle = `${entry.data.title} - odan blog`;
const title = entry.data.title;
const publishedAt = format(new Date(entry.data.publishedAt), "yyyy-MM-dd");
const description = entry.body.trim().slice(0, 90);
const { Content } = await entry.render();
---

<BaseLayout title={pageTitle} description={description}>
  <article>
    <header>
      <h1>{title}</h1>
      <time datetime={entry.data.publishedAt.toISOString()}>{publishedAt}</time>
    </header>
    <Content />
  </article>
</BaseLayout>
